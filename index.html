<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Tonal Explorer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="page-shell">
        <header class="page-header">
            <div class="title-row">
                <p class="eyebrow">Tonal Explorer</p>
                <button id="soundToggle" class="sound-toggle is-muted" aria-label="Unmute">
                    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 9v6h4l5 4V5L8 9H4z" fill="currentColor"/><path d="M16 8l4 4m0 0l-4 4m4-4H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                </button>
                <button id="infoButton" class="info-button" aria-label="About Tonal Explorer">i</button>
            </div>
        </header>

        <section id="inputArea" class="panel controls-panel">
            <div class="scale-stack">
                <div class="pill-row">
                    <div class="pill key-pill" id="keyPill" role="button" tabindex="0" aria-label="Select key">
                        <span class="pill-label">Key</span>
                        <span class="pill-right">
                          <span class="pill-value" id="keyPillValue"></span>
                        </span>
                    </div>
                    <button class="pill" id="modePill" aria-label="Select mode">
                        <span class="pill-label">Mode</span>
                        <span class="pill-value" id="modePillValue"></span>
                    </button>
                </div>
                <div id="scaleStrip" class="scale-strip" aria-label="Scale strip">
                    <div class="tile-viewport">
                        <div id="scaleTiles" class="scale-tiles" aria-live="polite"></div>
                    </div>
                </div>
                <div class="inline-actions">
                    <button id="random" class="ghost">Randomize</button>
                </div>
            </div>
        </section>

        <section id="outputArea" class="output-panel">
            <div id="mainContainer" class="main-grid">
                <div id="keymodeStrip" class="harmony-strip" role="button" tabindex="0" aria-label="Open key and mode selector">
                    <span id="keymodeStripLabel" class="harmony-strip-label">Key &amp; Mode</span>
                    <span class="harmony-strip-hint">Tap to change key/mode</span>
                </div>
                <div id="instrumentContainer" class="card instruments-card">
                    <div class="instrument-stack">
                        <div id="keyboardVisualizer" class="instrument keyboard" aria-label="Keyboard visualizer"></div>
                        <div id="fretboardVisualizer" class="instrument fretboard" aria-label="Guitar fretboard"></div>
                    </div>
                </div>
                <div id="harmonyStrip" class="harmony-strip" role="button" tabindex="0" aria-label="Open Harmony Explorer">
                    <span id="harmonyStripLabel">Harmony Explorer</span>
                    <span class="harmony-strip-hint">Tap to explore chords in this key</span>
                </div>
                <div id="harmonyContainer" class="card harmony-card">
                    <div class="harmony-grid-shell">
                        <div class="harmony-grid" id="harmonyGrid" role="grid" aria-label="Harmony Explorer grid">
                            <div class="harmony-grid-header" id="harmonyGridHeader"></div>
                            <div class="harmony-grid-body" id="harmonyGridBody"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>  
    </div>
    <div id="wheelModal" class="wheel-modal hidden" role="dialog" aria-modal="true">
        <div class="wheel-modal-backdrop"></div>
        <div class="wheel-modal-content">
            <div class="wheel-modal-header">
                <h3 id="wheelModalTitle">Select</h3>
                <button id="closeWheelModal" class="ghost micro" aria-label="Close">✕</button>
            </div>
            <div class="wheel-modal-list" id="wheelModalList" role="listbox" tabindex="-1"></div>
        </div>
    </div>
    <div id="infoModal" class="wheel-modal hidden" role="dialog" aria-modal="true">
        <div class="wheel-modal-backdrop"></div>
        <div class="wheel-modal-content info-modal">
            <div class="wheel-modal-header info-modal-header">
                <h3 id="infoTitle">Tonal Explorer</h3>
                <button id="closeInfoModal" class="ghost micro" aria-label="Close info">✕</button>
            </div>
            <div class="info-body" role="document">
                <p class="subhead">Explore keys, modes, and harmonies without leaving the browser.</p>
                <hr>
                <div class="info-section">
                    <p class="eyebrow subtle">Sound</p>
                    <ul>
                        <li>Speaker button toggles sound (starts muted).</li>
                        <li>Unmuting plays the current scale / note / chord.</li>
                        <li>Changes to key/mode or selecting notes/chords play after a swipe lands.</li>
                        <li>On iPhone/iPad, tap the speaker once to enable audio.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Key selection</p>
                    <ul>
                        <li>Tap the Key pill to choose a key.</li>
                        <li>For enharmonic keys (e.g., C#/Db), tap the key label to switch spelling.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Mode selection</p>
                    <ul>
                        <li>Tap the Mode pill to pick a mode.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Swipe / drag on tiles</p>
                    <ul>
                        <li>Swipe left/right to rotate through modes.</li>
                        <li>Swipe up/down to change key by semitone.</li>
                        <li>Longer drags can shift multiple steps.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Note tiles</p>
                    <ul>
                        <li>Tap a note tile to filter chords rooted on that note and highlight only that note on keyboard/fretboard.</li>
                        <li>Use All Chords to return to the full-scale view.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Harmony Explorer</p>
                    <ul>
                        <li>Tap a chord row to select it and highlight its tones.</li>
                        <li>Tap tone headers (3/5/7/9/11/13) to change chord depth.</li>
                        <li>Tap any tone cell in a row to preview that row at the tapped depth.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Keyboard &amp; fretboard</p>
                    <ul>
                        <li>Colors match the scale-degree tiles.</li>
                        <li>Visualizers update as you change key/mode or select notes/chords.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Mobile panels</p>
                    <ul>
                        <li>Use the Key &amp; Mode strip to expand the key/mode controls.</li>
                        <li>Use the Harmony Explorer strip to expand the chord grid.</li>
                    </ul>
                </div>
                <div class="info-section">
                    <p class="eyebrow subtle">Randomize</p>
                    <ul>
                        <li>Randomizes key and mode, updating tiles, visualizers, and chords.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <audio id="audioOut" playsinline></audio>
    <script src="script.js"></script>
</body>
</html>
